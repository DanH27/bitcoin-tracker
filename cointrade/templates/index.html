<!-- ./templates/index.html -->
<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CHART</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.1/css/bulma.min.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
  <style>
  @font-face {
    font-family: pix;
    src: url(/static/NESFont.ttf);
  }
  .chart {
    height: 800px;
  }
  body {
    font-family: pix;
    color: white;
    background-color: black;
  }
  .move-arrow {
    width: 100px;
    height: 100px;
    -webkit-transform: scaleX(-1);
    transform: scaleX(-1);

  }
  .move-arrow:hover {
    border: 2px solid red;
  }
  </style>
</head>
<body>
  <section class="section">
    <div class="container">
      <!-- <h1 class="title">Welcome to <strong>Crypto</strong>LiveChart!</h1>
      <p class="subtitle">View live prices for <strong>Bitcoin</strong> and <strong>Ethereum</strong> in real time!</p> -->
      <hr>
      <div class="columns">
        <div class="column">
          <h5 class="title is-6">Prices (in USD)</h5>
          <div id="price_chart" class="chart">
            GRAPH
          </div>
        </div>
        <div class="column">
          <h5 class="title is-6">Market Cap</h5>
          <div id="market_cap_chart" class="chart">
            BAR CHART
          </div>
        </div>




        <!-- <div class="column">
        <h5 class="title is-6">Monthly BTC</h5>
        <div id="monthly_btc_bar" class="chart">
        BTC Monthly Bar Chart (2014 - 2018)
      </div>
    </div> -->




  </div>
</div>
</section>
<a href="{{ url_for('main') }}"><img class="move-arrow" src="/static/move-arrow.png" /></a>
<section class="section">
  <div class="container">
    <div class="column">
      <h1 class="title is-6" id="b_price">{{bitcoinprice}}</h1>
      <h1>CASH:</h1>
      <h1 class="title is-6" id="m_left">{{moneyLeft}}</h1>
    </div>


    <form name="text" method="POST" action="/form">
      <input name="comp_select">
      <input type="submit" value="Buy">
    </form>






  </div>
</section>
<section class="section">
  <div class="container">
    <div class="column">
      <h1>PICK A CRYPTOCURRENCY TO BUY.</h1>
      <h1>SELECT A CRYPTOCURRENCY</h1>
      <table>
        <th>
          STOCK
        </th>
        <th>
          PRICE
        </th>
        <th>
          # COINS OWNED
        </th>
        <!-- Bitcoin Table Info -->
        <tr>
          <td id="bitcoin-table-name">
            BITCOIN (BTC)
          </td>
          <td id="bitcoin-table-price">
          </td>
          <td>
            0
          </td>
        </tr>
        <!-- DOGE Table Info -->
        <tr>
          <td id="dogecoin-table-name">
            DOGECOIN (DOGE)
          </td>
          <td id="doge-table-price">
          </td>
          <td>
            0
          </td>
        </tr>
        <!-- Litecoin Table Info -->
        <tr>
          <td id="litecoin-table-name">
            LITECOIN (LTC)
          </td>
          <td id="litecoin-table-price">
          </td>
          <td>
            0
          </td>
        </tr>
      </table>
    </div>
  </div>

</section>



<!-- D3.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js"></script>
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<!-- Plotly.js -->
<script src="https://d14fo0winaifog.cloudfront.net/plotly-basic.js"></script>
<!-- import Pusher-js library -->
<script src="https://js.pusher.com/4.1/pusher.min.js"></script>
<script type="text/javascript">
// connect to Pusher
const pusher = new Pusher('d0fbb6934c4ec3d8a001', {
  cluster: 'us2', // gotten from Pusher app dashboard
  encrypted: true // optional
});
// subscribe to crypto channel
const channel = pusher.subscribe('crypto')
// listen for relevant events

channel.bind('data-updated', data => {
  const graph = JSON.parse(data.graph);
  Plotly.newPlot('price_chart', graph, {showLink: false});
  const bar_chart = JSON.parse(data.bar_chart);
  Plotly.newPlot('market_cap_chart', bar_chart);
  document.getElementById('bitcoin-table-price').innerHTML =  "$" + data.btc_price;
  document.getElementById('m_left').innerHTML = "Budget: " + "$" + data.money_left;
  document.getElementById('litecoin-table-price').innerHTML = "$" + data.ltc_price;
  document.getElementById('doge-table-price').innerHTML = "$" + data.doge_price;



});
channel.bind('month-updated', data => {
  const btc_month = JSON.parse(data.btc_month_bar);
  Plotly.newPlot('monthly_btc_bar', btc_month);

});

channel.bind('ltc-month-updated', data => {
  const ltc_month = JSON.parse(data.ltc_month_bar);
  Plotly.newPlot('monthly_ltc_bar', ltc_month);

});

channel.bind('eth-month-updated', data => {
  const eth_month = JSON.parse(data.eth_month_bar);
  Plotly.newPlot('monthly_eth_bar', eth_month);

});



//     $(document).ready(function() {
//       $('#submit').click(function(event) {
//         event.preventDefault()
//          //var formdata = $("#bought").serialize();
//          //var value = $("#bought").val();
//          //console.log(value);
//          $.ajax({
//               type: 'POST',
//               contentType: 'application/json',
//               data: "",
//               dataType: 'json',
//               url: 'http://127.0.0.1:5000/',
//               success: function (e) {
//                   //document.getElementById('m_left').innerHTML = {{moneyLeft}} - {{bitcoinprice}};
//                   window.location.replace("http://127.0.0.1:5000/form")
//               },
//               error: function(error) {
//                 console.log(error);
//           }
//           });
//       });
// });


</script>
</body>
</html>
